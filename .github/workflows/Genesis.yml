# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
# â”ƒ ğŸ§  Genesis.yml - Ritual de geraÃ§Ã£o de artefatos por receita individual     â”ƒ
# â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

name: Genesis Ritual

on:
  push:
    paths:
      - recipes/**
      - bin/tutor.dart
      - lib/tutor/**
      - .github/workflows/Genesis.yml

jobs:
  preparar_matrix:
    runs-on: ubuntu-latest
    outputs:
      arquivos: ${{ steps.listar.outputs.arquivos }}
    steps:
      - name: ğŸ“¦ Checkout do grimÃ³rio
        uses: actions/checkout@v3

      - name: ğŸ“œ Listar arquivos em /recipes/
        id: listar
        run: |
          ARTEFATOS=$(ls recipes/*.txt | jq -R -s -c 'split("\n") | map(select(length > 0))')
          echo "arquivos=$ARTEFATOS" >> $GITHUB_OUTPUT

  gerar_artefatos:
    needs: preparar_matrix
    runs-on: ubuntu-latest
    strategy:
      matrix:
        arquivo: ${{ fromJson(needs.preparar_matrix.outputs.arquivos) }}

    steps:
      - name: ğŸ“¦ Checkout do grimÃ³rio
        uses: actions/checkout@v3

      - name: ğŸ§™ Instalar Dart
        uses: dart-lang/setup-dart@v1

      - name: ğŸ”® Gerar artefato para ${{ matrix.arquivo }}
        run: |
          echo "ğŸ”® Processando: ${{ matrix.arquivo }}"
          dart run bin/tutor.dart ${{ matrix.arquivo }}

      - name: ğŸ“ Mover artefato para LIMBO
        run: |
          nome=$(basename ${{ matrix.arquivo }} .txt)
          mkdir -p lib/limbo/
          mv artefatos/$nome.dart lib/limbo/
