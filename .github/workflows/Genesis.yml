name: ðŸŒŒ Genesis - CriaÃ§Ã£o e ValidaÃ§Ã£o de Rituais

on:
  workflow_dispatch:

jobs:
  tutor:
    name: ðŸ§™â€â™‚ï¸ Tutor-Demoniaco - Processar Recipes
    runs-on: ubuntu-latest
    steps:
      - name: Checkout do repositÃ³rio
        uses: actions/checkout@v3

      - name: Configurar Git
        run: |
          git config user.name "Tutor-Demoniaco"
          git config user.email "ritual@vdf.com"

      - name: Processar arquivos em recipes/
        run: |
          for file in Tutor-Demoniaco/recipes/*.txt; do
            nome=$(grep '^nome:' "$file" | cut -d':' -f2 | xargs)
            tipo=$(grep '^tipo:' "$file" | cut -d':' -f2 | xargs)
            descricao=$(grep '^descricao:' "$file" | cut -d':' -f2- | xargs)

            echo "ðŸ”§ Criando artefato: $nome ($tipo)"
            echo "ðŸ“œ DescriÃ§Ã£o: $descricao"

            # Criar arquivo Dart
            mkdir -p instrumentos_magicos
            echo "void main() => print('Executando $nome: $descricao');" > instrumentos_magicos/$nome.dart

            # Criar workflow de validaÃ§Ã£o
            mkdir -p .github/workflows
            cat <<EOF > .github/workflows/$nome.yml
name: ðŸ”¥ $nome - ValidaÃ§Ã£o em LIMBO

on:
  push:
    branches:
      - LIMBO

jobs:
  testar-$nome:
    name: ðŸ§ª Testar $nome
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Instalar Dart
        uses: dart-lang/setup-dart@v1
      - name: Executar $nome.dart
        run: dart instrumentos_magicos/$nome.dart
EOF

            # Mover para LIMBO
            git checkout LIMBO
            git pull origin LIMBO
            git add instrumentos_magicos/$nome.dart .github/workflows/$nome.yml
            git commit -m "âœ¨ Ritual $nome criado pelo Tutor e enviado para LIMBO"
            git push origin LIMBO
          done
