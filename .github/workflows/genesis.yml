# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
# â”ƒ âš™ï¸ genesis.yaml - Ritual completo com aÃ§Ãµes encadeadas e seladas           â”ƒ
# â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

name: Genesis Ritual

on:
  push:
    branches:
      - Tutor-DemonÃ­aco
    paths:
      - 'recipe/**'
      - 'bin/genesis.dart'
  workflow_dispatch: {}

jobs:
  artefato:
    name: ðŸ§± action: artefato
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¦ Checkout do grimÃ³rio
        uses: actions/checkout@v3

      - name: ðŸ§™ Instalar Dart
        uses: dart-lang/setup-dart@v1

      - name: ðŸ“¦ Instalar dependÃªncias
        run: |
          dart pub get

      - name: ðŸ”® Invocar rituais e gerar artefatos
        run: |
          dart run bin/genesis.dart

  movendo_artefato:
    name: ðŸ“¦ action: movendo artefato
    needs: artefato
    runs-on: ubuntu-latest
    steps:
      - name: Mover artefatos para LIMBO/lib/limbo
        run: |
          mkdir -p lib/limbo
          cp artefatos/*.dart lib/limbo/

  testes:
    name: ðŸ§ª action: testes
    needs: movendo_artefato
    runs-on: ubuntu-latest
    steps:
      - name: Validar artefatos e simular falhas
        run: |
          mkdir -p lib/infernus
          for f in artefatos/*.dart; do
            dart analyze "$f" || (
              nome=$(basename "$f" .dart)
              cp "$f" lib/infernus/
              mv "recipe/$nome.txt" "recipe/${nome}_infernus"
            )
          done

  valido:
    name: âœ… action: valido
    needs: testes
    runs-on: ubuntu-latest
    steps:
      - name: Editar conjurafor.yml no LIMBO
        run: |
          echo "# Novo job para artefato" >> .github/workflows/conjurafor.yml

  ok:
    name: ðŸª„ action: ok
    needs: valido
    runs-on: ubuntu-latest
    steps:
      - name: Promover artefato para Instrumentos-MÃ¡gicos, GRIMORIO e ExtraPlanares
        run: |
          mkdir -p instrumento ritual extraplanar
          cp artefatos/*.dart instrumento/
          cp artefatos/*.dart ritual/
          cp artefatos/*.dart extraplanar/

      - name: Atualizar README com nome do artefato
        run: |
          nome=$(basename artefatos/*.dart .dart)
          echo "- $nome" >> README.md
