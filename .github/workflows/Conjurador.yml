name: 🧙‍♂️ Conjurador

on:
  workflow_dispatch:
    inputs:
      ritual:
        description: "Nome do ritual a ser conjurado"
        required: true
        default: "vigilancia_silenciosa"

jobs:
  passo_1_gerar:
    name: 🧪 Gerar artefatos
    runs-on: ubuntu-latest
    steps:
      - name: Checkout do repositório
        uses: actions/checkout@v3

      - name: Instalar Dart
        uses: dart-lang/setup-dart@v1

      - name: Executar Gerador Ritualico
        run: |
          echo "🔧 Gerando ritual: ${{ github.event.inputs.ritual }}"
          dart instrumentos_magicos/gerador_ritualico.dart ${{ github.event.inputs.ritual }}

  passo_2_migrar:
    name: 📦 Migrar para Grimório
    needs: passo_1_gerar
    runs-on: ubuntu-latest
    steps:
      - name: Checkout do repositório
        uses: actions/checkout@v3

      - name: Instalar Dart
        uses: dart-lang/setup-dart@v1

      - name: Executar Migrador Grimório
        run: |
          echo "📦 Migrando ritual: ${{ github.event.inputs.ritual }}"
          dart instrumentos_magicos/migrador_grimorio.dart ${{ github.event.inputs.ritual }}

  passo_3_selar:
    name: 🔮 Selar com aprovação
    needs: passo_2_migrar
    runs-on: ubuntu-latest
    steps:
      - name: Checkout do repositório
        uses: actions/checkout@v3

      - name: Instalar Dart
        uses: dart-lang/setup-dart@v1

      - name: Executar Selador Demoníaco
        run: |
          echo "🔮 Selando ritual: ${{ github.event.inputs.ritual }}"
          dart instrumentos_magicos/selador_demoníaco.dart ${{ github.event.inputs.ritual }}
