# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃ 🔮 Conjurador.yml - Workflow que escuta rituais criados por DrEstranho┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

name: Conjurador Dimensional

on:
  push:
    paths:
      - 'recipes/**'
  workflow_dispatch:

jobs:
  ritual:
    name: 🧙‍♂️ Invocação Inicial do Ritual
    runs-on: ubuntu-latest

    steps:
      # ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
      # ┃ 📦 Etapa 1 - Checkout do Grimório                         ┃
      # ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
      - name: 📦 Checkout do Grimório
        uses: actions/checkout@v3

      # ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
      # ┃ 🔍 Etapa 2 - Identificar novo ritual                     ┃
      # ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
      - name: 🔍 Identificar novo ritual criado
        run: |
          echo "📜 Procurando rituais em recipes/"
          ls recipes/*.txt || echo "⚠️ Nenhum ritual .txt encontrado."

      # ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
      # ┃ 🧪 Etapa 3 - Validar estrutura do ritual                 ┃
      # ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
      - name: 🧪 Validar estrutura do ritual
        run: |
          for file in recipes/*.txt; do
            echo "🔍 Validando $file"
            if grep -q "nome:" "$file" && grep -q "destino:" "$file"; then
              echo "✅ Estrutura válida"
            else
              echo "⚠️ Estrutura incompleta"
            fi
          done

      # ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
      # ┃ 🧠 Etapa 4 - Registrar ritual na malha                   ┃
      # ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
      - name: 🧠 Registrar ritual na malha
        run: |
          echo "🧠 Ritual registrado na malha dimensional"
          echo "status: em teste" >> recipes/status.log

      # ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
      # ┃ 🚀 Etapa 5 - Simular envio para LIMBO                    ┃
      # ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
      - name: 🚀 Simular envio para LIMBO
        run: |
          echo "🚀 Ritual será transferido para lib/limbo/ na branch LIMBO"
          echo "📦 Preparando artefato para testes dimensionais"

      # ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
      # ┃ 📤 Etapa 6 - Comitar evolução ritualística                ┃
      # ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
      - name: 📤 Comitar evolução ritualística
        run: |
          git config --global user.name "Tutor-Demoníaco"
          git config --global user.email "ritualista@vdf.com"
          git add recipes/status.log
          git commit -m "Tutor-Demoníaco: ritual registrado e pronto para LIMBO"
          git push
